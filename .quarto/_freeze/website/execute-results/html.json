{
  "hash": "2203b41ad5e92bd0b851d9088d441cd4",
  "result": {
    "markdown": "# Website {#sec-website}\n\n\n::: {.cell}\n\n:::\n\n\nAt this point, we've discussed many ways to document your package:\n\n-   Function documentation or, more generally, help topics (@sec-man).\n\n-   Documentation of datasets (@sec-documenting-data).\n\n-   Vignettes (and articles) (@sec-vignettes).\n\n-   README and NEWS (@sec-other-markdown).\n\nWouldn't it be divine if all of that somehow got bundled up together into a beautiful website for your package?\nThe [pkgdown package](https://pkgdown.r-lib.org) is meant to provide exactly this magic and that is the topic of this chapter.\n\n## Initiate a site\n\nAssuming your package has a valid structure, pkgdown should be able to make a website for it.\nObviously that website will be more substantial if your package has more of the documentation elements listed above.\nBut something reasonable should happen for any valid R package.\n\n::: callout-tip\nWe hear that some folks put off \"learning pkgdown\", because they think it's going to be a lot of work.\nBut then they eventually execute the two commands we show next and have a decent website in less than five minutes!\n:::\n\n`usethis::use_pkgdown()` is a function you run once and it does the initial, minimal setup necessary to start using pkgdown:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::use_pkgdown()\n```\n:::\n\n\n\n::: {.cell}\n\n```\n#> ✔ Setting active project to 'C:/Users/13081/AppData/Local/Temp/Rtmp2RqL0Q/mypackage'\n#> ✔ Adding '^_pkgdown\\\\.yml$', '^docs$', '^pkgdown$' to '.Rbuildignore'\n#> ✔ Adding 'docs' to '.gitignore'\n#> ✔ Writing '_pkgdown.yml'\n#> • Edit '_pkgdown.yml'\n#> ✔ Setting active project to '<no active project>'\n```\n:::\n\n\nHere's what `use_pkgdown()` does:\n\n-   Creates `_pkgdown.yml`, which is the main configuration file for pkgdown.\n    In an interactive session, `_pkgdown.yml` will be opened for inspection and editing.\n    But there's no immediate need to change or add anything here.\n\n-   Adds various patterns to `.Rbuildignore`, to keep pkgdown-specific files and directories from being included in your package bundle.\n\n-   Adds `docs`, the default destination for a rendered site, to `.gitignore`.\n    This is harmless for those who don't use Git.\n    For those who do, this opts you in to our recommended lifestyle, where the definitive source for your pkgdown site is built and deployed elsewhere (probably via GitHub Actions and Pages; more on this soon).\n    This means the rendered website at `docs/` just serves as a local preview.\n\n`pkgdown::build_site()` is a function you'll call repeatedly, to re-render your site locally.\nIn an extremely barebones package, you'll see something like this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npkgdown::build_site()\n```\n:::\n\n::: {.cell}\n\n```\n#> ✔ Setting active project to\n#> 'C:/Users/13081/AppData/Local/Temp/Rtmp2RqL0Q/mypackage'\n#> -- Installing package into temporary library -----------------------\n#> == Building pkgdown site =======================================================\n#> Reading from: 'C:/Users/13081/AppData/Local/Temp/Rtmp2RqL0Q/mypackage'\n#> Writing to:   'C:/Users/13081/AppData/Local/Temp/Rtmp2RqL0Q/mypackage/docs'\n#> -- Initialising site -----------------------------------------------------------\n#> Copying '../../../../../../../../D:/1.study/R/R-4.2.0/library/pkgdown/BS5/assets/link.svg' to 'link.svg'\n#> Copying '../../../../../../../../D:/1.study/R/R-4.2.0/library/pkgdown/BS5/assets/pkgdown.js' to 'pkgdown.js'\n#> -- Building home ---------------------------------------------------------------\n#> Writing 'authors.html'\n#> Writing '404.html'\n#> -- Building function reference -------------------------------------------------\n#> Writing 'reference/index.html'\n#> Writing 'sitemap.xml'\n#> -- Building search index -------------------------------------------------------\n#> == DONE ========================================================================\n#> ✔ Setting active project to '<no active project>'\n```\n:::\n\n\nIn an interactive session your newly rendered site should appear in your default web browser.\n\n::: callout-tip\n## RStudio\n\nAnother nice gesture to build your site is via *Addins \\> pkgdown \\> Build pkgdown*.\n:::\n\nYou can look in the local `docs/` directory to see the files that constitute your package's website.\nTo manually browse the site, open `docs/index.html` in your preferred browser.\n\nThis is almost all you truly need to know about pkgdown.\nIt's certainly a great start and, as your package and ambitions grow, the best place to learn more is the pkgdown-made website for the pkgdown package itself: <https://pkgdown.r-lib.org>.\n\n## Deployment {#sec-website-deployment}\n\nYour next task is to deploy your pkgdown site somewhere on the web, so that your users can visit it.\nThe path of least resistance looks like this:\n\n-   Use Git and host your package on GitHub.\n    The reasons to do this go well beyond offering a package website, but this will be one of the major benefits to adopting Git and GitHub, if you're on the fence.\n\n-   Use GitHub Actions (GHA) to build your website, i.e. to run `pkgdown::build_site()`.\n    GHA is a platform where you can configure certain actions to happen automatically when some event happens.\n    We'll use it to rebuild your website every time you push to GitHub.\n\n-   Use GitHub Pages to serve your website, i.e. the files you see below `docs/` locally.\n    GitHub Pages is a static website hosting service that creates a site from files found in a GitHub repo.\n\nThe advice to use GitHub Action and Pages are implemented for you in the function `usethis::use_pkgdown_github_pages()`.\nIt's not an especially difficult task, but there are several steps and it would be easy to miss or flub one.\nThe output of `use_pkgdown_github_pages()` should look something like this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::use_pkgdown_github_pages()\n#> ✔ Initializing empty, orphan 'gh-pages' branch in GitHub repo 'jane/mypackage'\n#> ✔ GitHub Pages is publishing from:\n#> • URL: 'https://jane.github.io/mypackage/'\n#> • Branch: 'gh-pages'\n#> • Path: '/'\n#> ✔ Creating '.github/'\n#> ✔ Adding '^\\\\.github$' to '.Rbuildignore'\n#> ✔ Adding '*.html' to '.github/.gitignore'\n#> ✔ Creating '.github/workflows/'\n#> ✔ Saving 'r-lib/actions/examples/pkgdown.yaml@v2' to '.github/workflows/pkgdown.yaml'\n#> • Learn more at <https://github.com/r-lib/actions/blob/v2/examples/README.md>.\n#> ✔ Recording 'https://jane.github.io/mypackage/' as site's url in '_pkgdown.yml'\n#> ✔ Adding 'https://jane.github.io/mypackage/' to URL field in DESCRIPTION\n#> ✔ Setting 'https:/jane.github.io/mypackage/' as homepage of GitHub repo 'jane/mypackage'\n```\n:::\n\n\nLike `use_pkgdown()`, this is a function you basically call once, when setting up a new site.\nIn fact, the first thing it does is to call `use_pkgdown()` (it's OK if you've already called `use_pkgdown()`), so we usually skip straight to `use_pkgdown_github_pages()` when setting up a new site.\n\nLet's walk through what `use_pkgdown_github_pages()` actually does:\n\n-   Initializes an empty, \"orphan\" branch in your GitHub repo, named `gh-pages` (for \"GitHub Pages\").\n    The `gh-pages` branch will only live on GitHub (there's no reason to fetch it to your local computer) and it represents a separate, parallel universe from your actual package source.\n    The only files tracked in `gh-pages` are those that constitute your package's website (the files that you see locally below `docs/`).\n\n-   Turns on GitHub Pages for your repo and tells it to serve a website from the files found in the `gh-pages` branch.\n\n-   Copies the configuration file for a GHA workflow that does pkgdown \"build and deploy\".\n    The file shows up in your package as `.github/workflows/pkgdown.yaml`.\n    If necessary, some related additions are made to `.gitignore` and `.Rbuildignore`.\n\n-   Adds the URL for your site as the homepage for your GitHub repo.\n\n-   Adds the URL for your site to `DESCRIPTION` and `_pkgdown.yml`.\n    The autolinking behaviour we've touted elsewhere relies on your package listing its URL in these two places, so this is a high-value piece of configuration.\n\nAfter successful execution of `use_pkgdown_github_pages()`, you should be able to visit your new site at the URL displayed in the output above.[^website-1]\nBy default the URL has this general form: `https://USERNAME.github.io/REPONAME/`.\n\n[^website-1]: Sometimes there's a small delay, so give it up to a couple of minutes to deploy.\n\n## Now what?\n\nFor a typical package, you could stop here --- after creating a basic pkgdown site and arranging for it to be re-built and deployed regularly --- and people using (or considering using) your package would benefit greatly.\nEverything beyond this point is a \"nice to have\".\n\nOverall, we recommend `vignette(\"pkgdown\", package = \"pkgdown\")` as a good place to start, if you think you want to go beyond the basic defaults.\n\nIn the sections below, we highlight a few areas that are connected to other topics in the book or customizations that are particularly rewarding.\n\n## Logo\n\nIt's fun to have a package logo!\nIn the R community, we have a strong tradition of hex stickers, so it can be nice to join in with a hex logo of your own.\nKeen R user Amelia McNamara [made herself a dress](https://www.amelia.mn/blog/misc/2019/08/17/Tidy-Dress.html) out of custom hex logo fabric and useR!\n2018 featured a [spectacular hex photo wall](https://www.mitchelloharawild.com/blog/hexwall/).\n\nHere are some resources to guide your logo efforts:\n\n-   The convention is to orient the logo with a vertex at the top and bottom, with flat vertical sides.\n\n-   If you think you might print stickers, make sure to comply with the *de facto* standard for sticker size.\n    [hexb.in](http://hexb.in/sticker.html) is a reliable source for the dimensions and also provides a list of potential vendors for printed stickers.\n\n\n    ::: {.cell}\n    ::: {.cell-output-display}\n    ![Standard dimensions of a hex sticker.\n    ](diagrams/hex-image.png){#fig-hex-sticker-spec fig-alt='A hexagon oriented with points at the top and bottom and flat vertical sides. It is labelled with dimensions: 5.08cm (2\") vertically (point to point), and 4.39cm (1.73\") horizontally (flat side to flat side).' width=35%}\n    :::\n    :::\n\n\n-   The [hexSticker package](https://cran.r-project.org/package=hexSticker) helps you make your logo from within the comfort of R.\n\nOnce you have your logo, the `usethis::use_logo()` function places an appropriately scaled copy of the image file at `man/figures/logo.png` and also provides a copy-paste-able markdown snippet to include your logo in your `README`.\npkgdown will also discover a logo placed in the standard location and incorporate it into your site.\n\n## Reference index\n\npkgdown creates a function reference in `reference/` that includes one page for each `.Rd` help topic in `man/`.\nThis is one of the first pages you should admire in your new site.\nAs you look around, there are a few things to contemplate, which we review below.\n\n### Rendered examples\n\npkgdown executes all your examples (@sec-man-examples) and inserts the rendered results.\nWe find this is a fantastic improvement over just showing the source code.\nThis view of your examples can be eye-opening and often you'll notice things you want to add, omit, or change.\nIf you're not satisfied with how your examples appear, this is a good time to review techniques for including code that is expected to error (@sec-man-examples-errors) or that can only be executed under certain conditions (@sec-man-examples-dependencies-conditional-execution).\n\n### Linking {#sec-website-reference-linking}\n\nThese help topics will be linked to from many locations within and, potentially, beyond your pkgdown site.\nThis is what we are talking about in @sec-man-key-md-features when we recommend putting functions inside square brackets when mentioning them in a roxygen comment:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#' I am a big fan of [thisfunction()] in my package. I\n#' also have something to say about [otherpkg::otherfunction()]\n#' in somebody else's package.\n```\n:::\n\n\nOn pkgdown sites, those square-bracketed functions become hyperlinks to the relevant pages in your pkgdown site.\nThis is automatic within your package.\nBut inbound links from *other* people's packages (and websites, etc.) require two things[^website-2]:\n\n[^website-2]: Another pre-requisite is that your package has been released on CRAN, because the auto-linking machinery has to look up the `DESCRIPTION` somewhere.\n    It is possible to allow locally installed packages to link to each other, which is described in `vignette(\"linking\", package = \"pkgdown\")`.\n\n-   The `URL` field of your `DESCRIPTION` file must include the URL of your pkgdown site (preferably followed by the URL of your GitHub repo):\n\n    ``` yaml\n    URL: https://dplyr.tidyverse.org, https://github.com/tidyverse/dplyr\n    ```\n\n-   Your `_pkgdown.yml` file must include the URL for your site:\n\n    ``` yaml\n    url: https://dplyr.tidyverse.org\n    ```\n\ndevtools takes every chance it gets to do this sort of configuration for you.\nBut if you elect to do things manually, this is something you might overlook.\nA general resource on auto-linking in pkgdown is `vignette(\"linking\", package = \"pkgdown\")`.\n\n### Index organization\n\nBy default, the reference index is just an alphabetically-ordered list of functions.\nFor packages with more than a handful of functions, it's often worthwhile to curate the index and organize the functions into groups.\nFor example, dplyr uses this technique: <https://dplyr.tidyverse.org/reference/index.html>.\n\nYou achieve this by providing a `reference` field in `_pkgdown.yml`.\nHere's a redacted excerpt from dplyr's `_pkgdown.yml` file that gives you a sense of what's involved:\n\n``` yaml\nreference:\n- title: Data frame verbs\n\n- subtitle: Rows\n  desc: >\n    Verbs that principally operate on rows.\n  contents:\n  - arrange\n  - distinct\n  ...\n\n- subtitle: Columns\n  desc: >\n    Verbs that principally operate on columns.\n  contents:\n  - glimpse\n  - mutate\n  ...\n\n- title: Vector functions\n  desc: >\n    Unlike other dplyr functions, these functions work on individual vectors,\n    not data frames.\n  contents:\n  - between\n  - case_match\n  ...\n\n- title: Built in datasets\n  contents:\n  - band_members\n  - starwars\n  - storms\n  ...\n\n- title: Superseded\n  desc: >\n    Superseded functions have been replaced by new approaches that we believe\n    to be superior, but we don't want to force you to change until you're\n    ready, so the existing functions will stay around for several years.\n  contents:\n  - sample_frac\n  - top_n\n  ...\n```\n\nTo learn more, see `?pkgdown::build_reference`.\n\n## Vignettes and articles\n\n@sec-vignettes deals with vignettes, which are long-form guides for a package.\nThey afford various opportunities beyond what's possible in function documentation.\nFor example, you have much more control over the integration of prose and code and over the presentation of code itself, e.g. code can be executed but not seen, seen but not executed, and so on.\nIt's much easier to create the reading experience that best prepares your users for authentic usage of your package.\n\nA package's vignettes appear, in rendered form, in its website, in the *Articles* dropdown menu.\n\"Vignette\" feels like a technical term that we might not expect all R users to know, which is why pkgdown uses the term \"articles\" here.\nTo be clear, the *Articles* menu lists your package's official vignettes (the ones that are included in your package bundle) and, optionally, other non-vignette articles (@sec-vignettes-article), which are only available on the website.\n\n### Linking\n\nLike function documentation, vignettes can also be the target of automatic inbound links from within your package and, potentially, beyond.\nWe've talked about this elsewhere in the book.\nIn @sec-man-key-md-features, we introduced the idea of referring to a vignette with an inline call like `vignette(\"some-topic\")`.\nThe rationale behind this syntax is because the code can literally be copied, pasted, and executed for local vignette viewing.\nSo it \"works\" in any context, even without automatic links.\nBut, in contexts where the auto-linking machinery is available, it knows to look for this exact syntax and turn it into a hyperlink to the associated vignette, within a pkgdown site.\n\nThe need to specify the host package depends on the context:\n\n-   `vignette(\"some-topic\")`: Use this form in your own roxygen comments, vignettes, and articles, to refer to a vignette in your package.\n    The host package is implied.\n\n-   `vignette(\"some-topic\", package = \"somepackage\")`: Use this form to refer to a vignette in some other package.\n    The host package must be explicit.\n\nNote that this shorthand does **not** work for linking to non-vignette articles.\nSince the syntax leans so heavily on the `vignette()` function, it would be too confusing, i.e. evaluating the code in the console would fail because R won't be able to find such a vignette.\nNon-vignette articles must be linked like any other URL.\n\nWhen you refer to a function in your package, in your vignettes and articles, make sure to put it inside backticks and to include parentheses.\nQualify functions from other packages with their namespace.\nHere's an example of prose in one of your own vignettes or articles:\n\n``` markdown\nI am a big fan of `thisfunction()` in my package. I also have something to\nsay about `otherpkg::otherfunction()` in somebody else's package.\n```\n\nRemember that automatic inbound links from *other* people's packages (and websites, etc.) require that your package advertises the URL of its website in `DESCRIPTION` and `_pkgdown.yaml`, as configured by `usethis:: use_pkgdown_github_pages()` and as described in @sec-website-reference-linking.\n\n### Index organization\n\nAs with the reference index, the default listing of the articles (broadly defined) in a package is alphabetical.\nBut if your package has several articles, it can be worthwhile to provide additional organization.\nFor example, you might feature the articles aimed at the typical user and tuck those meant for advanced users or developers behind \"More articles ...\".\nYou can learn more about this in `?pkgdown::build_articles`.\n\n### Non-vignette articles\n\nIn general, @sec-vignettes is our main source of advice on how to approach vignettes and that also includes some coverage of non-vignette articles (@sec-vignettes-article).\nHere we review some reasons to use a non-vignette article and give some examples.\n\nAn article is morally like a vignette (e.g. it tells a story that involves multiple functions and is written with R markdown), except it does not ship with the package bundle.\n`usethis::use_article()` is the easiest way to create an article.\nThe main reason to use an article is when you want to show code that is impossible or very painful to include in a vignette or official example.\nPossible root causes of this pain:\n\n-   Use of a package you don't want to formally depend on.\n    In vignettes and examples, it's forbidden to show your package working with a package that you don't list in `DESCRIPTION`, e.g. in `Imports` or `Suggests`.\n\n    There is a detailed example of this in @sec-dependencies-nonstandard-config-needs, featuring a readxl article that uses the tidyverse meta-package.\n    The key idea is to list such a dependency in the `Config/Needs/website` field of `DESCRIPTION`.\n    This keeps tidyverse out of readxl's dependencies, but ensures it's installed when the website is built.\n\n-   Code that requires authentication or access to specific assets, tools, or secrets that are not available on CRAN.\n\n    The [googledrive package](https://googledrive.tidyverse.org) has no true vignettes, only non-vignette articles, because it's essentially impossible to demonstrate usage without authentication.\n    It is possible to access secure environment variables on GitHub Actions, where the pkgdown site is built and deployed, but this is impossible to do on CRAN.\n\n-   Content that involves a lot of figures, which cause your package to bump up against CRAN's size constraints.\n\n    The ggplot2 package [presents several FAQs as articles](https://ggplot2.tidyverse.org/articles/index.html) for this reason.\n\n## Development mode\n\nEvery pkgdown site has a so-called [*development mode*](https://pkgdown.r-lib.org/reference/build_site.html#development-mode), which can be specified via the `development` field in `_pkgdown.yml`.\nIf unspecified, the default is `mode: release`, which results in a single pkgdown site.\nDespite the name, this single site reflects the state of the current source package, which could be either a released state or a development state.\nThe diagram below shows the evolution of a hypothetical package that is on CRAN and that has a pkgdown site in \"release\" mode.\n\n```         \n...\n |\n V\nTweaks before release     v0.1.9000\n |\n V\nIncrement version number  v0.2.0     <-- install.packages() gets this\n |\n V\nIncrement version number  v0.2.9000  \n |\n V\nImprove error message     v0.2.9000  <-- site documents this\n |\n V\n...\n```\n\nUsers who install from CRAN get version 0.2.0.\nBut the pkgdown site is built from the development version of the package.\n\nThis creates the possibility that users will read about some new feature on the website that is not present in the package version that they have installed with `install.packages()`.\nWe find that the simplicity of this setup outweighs the downsides, until a package has a broad user base, i.e. lots of users of varying levels of sophistication.\nIt's probably safe to stay in \"release\" mode until you actually hear from a confused user.\n\nPackages with a substantial user base should use \"auto\" development mode:\n\n``` yaml\ndevelopment:\n  mode: auto\n```\n\nThis directs pkgdown to generate a top-level site from the released version and to document the development version in a `dev/` subdirectory.\nWe revisit the same hypothetical package as above, but assuming the pkdown site is in \"auto\" mode.\n\n```         \n...\n |\n V\nTweaks before release     v0.1.9000\n |\n V\nIncrement version number  v0.2.0     <-- install.packages() gets this\n |                                       main site documents this\n V\nIncrement version number  v0.2.9000  \n |\n V\nImprove error message     v0.2.9000  <-- dev/ site documents this\n |\n V\n...\n```\n\nAll of the core tidyverse packages use \"auto\" mode.\nFor example, consider the website of the readr package:\n\n-   [readr.tidyverse.org](https://readr.tidyverse.org) documents the released version, i.e. what `install.packages(\"readr\")` delivers.\n\n-   [readr.tidyverse.org/dev/](https://readr.tidyverse.org/dev/) documents the dev version, i.e. what `install_github(\"tidyverse/readr\")` delivers.\n\nAutomatic development mode is recommended for packages with a broad user base, because it maximizes the chance that a user will read web-based documentation that reflects the package version that is locally installed.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}